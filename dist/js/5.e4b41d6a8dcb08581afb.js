webpackJsonp([5],{330:function(e,t,i){function n(e){i(623)}var a=i(1)(i(523),i(672),n,null,null);e.exports=a.exports},523:function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0});var a=i(529),s=n(a),l=i(118),r=n(l),o=i(119),c=i(9);t.default={name:"outbox",data:function(){return{list:null,total:null,listLoading:!0,listQuery:{page:1,limit:20,title:void 0,receciveName:void 0,receciveMail:void 0,sort:"",order:""},multipleSelection:[],tableKey:0,labelList:[]}},created:function(){this.initPage()},filters:{showReceiveName:function(e){var t="";return e.forEach(function(e){return t+=e.name+";"}),t}},methods:{initPage:function(){this.getList(),this.getLabelList()},getList:function(){var e=this;this.listLoading=!0,s.fetchList(this.listQuery).then(function(t){e.list=t.data.items,e.total=t.data.total,e.listLoading=!1})},getLabelList:function(){var e=this;r.fetchList().then(function(t){e.labelList=t.data.labelList})},handleFilter:function(){this.getList()},handleSizeChange:function(e){this.listQuery.limit=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()},customSort:function(e){this.listQuery.sort=e.prop,this.listQuery.order=e.order,this.getList()},timeFilter:function(e){if(!e[0])return this.listQuery.start=void 0,void(this.listQuery.end=void 0);this.listQuery.start=parseInt(+e[0]/1e3),this.listQuery.end=parseInt((+e[1]+864e5)/1e3)},goToDetail:function(e){this.$store.commit("SET_MAIL_ID",e),this.$store.commit("SET_MAIL_TYPE","send"),this.$router.push({path:"/mail_detail/index"})},edit:function(){if(1!==(this.multipleSelection.length||0))return void this.$message("Please select an email to edit");this.$store.commit("SET_MAIL_ID",this.multipleSelection[0].id),this.$store.commit("SET_PAGE_TYPE","edit"),this.$store.commit("SET_MAIL_TYPE","send"),this.$router.push({path:"/mail_send/index"})},forward:function(){if(1!==(this.multipleSelection.length||0))return void this.$message("Please select an email to forward");this.$store.commit("SET_MAIL_ID",this.multipleSelection[0].id),this.$store.commit("SET_PAGE_TYPE","forward"),this.$store.commit("SET_MAIL_TYPE","send"),this.$router.push({path:"/mail_send/index"})},handleSelectionChange:function(e){this.multipleSelection=e},handleDelete:function(){var e=this,t=this.multipleSelection.length||0;if(t<1)return void this.$message("Please select a message to delete");this.$confirm("Are you sure want to delete this "+t+"Mail?","Confirm",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(function(){var t=[];e.multipleSelection.forEach(function(e){return t.push(e.id)}),s.delSendMail(t).subscribe({next:function(){e.$message({message:"Successfully deleted",type:"success",duration:2e3}),e.getList()},error:function(){return e.$message({showClose:!0,message:"Failed to delete",type:"error"})}})}).catch(function(){e.$message("Operation canceled")})},handleDownload:function(){var e=this;i.e(20).then(function(){var t=i(360),n=t.export_json_to_excel,a=["Recipient","Subject","Sending time"],s=["receiveList","title","sendDate"];n(a,e.formatJson(s,e.list),(0,c.parseTime)(Date.now())+"Outbox data")}.bind(null,i)).catch(i.oe)},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){if(~e.indexOf("Date"))return(0,c.parseTime)(t[e]);if("Array"===(0,o.getType)(t[e])){var i="";return t[e].forEach(function(e){return i+=e.name+"<"+e.mail+">;"}),i}return t[e]})})},toggleStar:function(e){var t=this,i=[];if(e)i.push(e.id);else{if((this.multipleSelection.length||0)<1)return void this.$message("Please select a message to mark");this.multipleSelection.forEach(function(e){return i.push(e.id)})}r.toggleStar(i).subscribe({next:function(){e?e.isStar=!e.isStar:t.multipleSelection.forEach(function(e){return e.isStar=!0})}})},handleMark:function(e){var t=this;if("star"===e)this.toggleStar();else{if((this.multipleSelection.length||0)<1)return void this.$message("Please select a message to mark");var i=[];this.multipleSelection.forEach(function(e){return i.push(e.id)}),r.markLabel(e,i).subscribe({next:function(){return t.getList()}})}}}}},529:function(e,t,i){"use strict";function n(e){return(0,l.default)({url:"/outbox/list",method:"get",params:e})}function a(e){var t=String(e);return console.log("The sender id to delete:"+t),r.Observable.create(function(e){setTimeout(function(){e.next(!0)},1e3)})}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchList=n,t.delSendMail=a;var s=i(38),l=function(e){return e&&e.__esModule?e:{default:e}}(s),r=i(64)},540:function(e,t,i){t=e.exports=i(311)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"index.vue",sourceRoot:""}])},623:function(e,t,i){var n=i(540);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i(312)("264847c8",n,!0)},672:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container calendar-list-container"},[i("div",{staticClass:"filter-container"},[i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"tool-item filter-item btn-edit",attrs:{type:"primary",icon:"edit"},on:{click:e.edit}}),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"tool-item filter-item btn-forward",attrs:{type:"primary",icon:"share"},on:{click:e.forward}}),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"tool-item filter-item btn-del",attrs:{type:"danger",icon:"delete"},on:{click:function(t){e.handleDelete()}}}),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"tool-item filter-item btn-reload",attrs:{type:"primary"},on:{click:e.initPage}},[i("icon-svg",{attrs:{"icon-class":"reload4"}})],1),e._v(" "),i("el-dropdown",{staticClass:"tool-item filter-item",attrs:{"split-button":"",type:"primary","menu-align":"start"},on:{command:e.handleMark}},[e._v("\n            Mark as\n            "),i("el-dropdown-menu",{slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"star"}},[i("icon-svg",{staticClass:"download-icon",attrs:{"icon-class":"favourite"}}),e._v("Star mail")],1),e._v(" "),e._l(e.labelList,function(t){return i("el-dropdown-item",{key:t.id,attrs:{command:t.id+""}},[i("icon-svg",{staticClass:"download-icon",attrs:{"icon-class":"label1"}}),e._v(e._s(t.name))],1)})],2)],1),e._v(" "),i("el-input",{staticClass:"filter-item",staticStyle:{width:"300px"},attrs:{placeholder:"title"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;e.handleFilter(t)}},model:{value:e.listQuery.title,callback:function(t){e.listQuery.title=t},expression:"listQuery.title"}}),e._v(" "),i("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"Recipient"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;e.handleFilter(t)}},model:{value:e.listQuery.receiveName,callback:function(t){e.listQuery.receiveName=t},expression:"listQuery.receiveName"}}),e._v(" "),i("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"Receiving mailbox"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;e.handleFilter(t)}},model:{value:e.listQuery.receiveMail,callback:function(t){e.listQuery.receiveMail=t},expression:"listQuery.receiveMail"}}),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"search"},on:{click:e.handleFilter}},[e._v("Search for")]),e._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"text",icon:"document"},on:{click:e.handleDownload}},[e._v("Export")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:e.tableKey,ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.list,border:"","highlight-current-row":""},on:{"sort-change":e.customSort,"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection","min-width":"30px"}}),e._v(" "),i("el-table-column",{attrs:{align:"left",width:"90px",label:"information"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("icon-svg",{staticClass:"star",attrs:{"icon-class":t.row.isStar?"favourite":"favourite-o"},nativeOn:{click:function(i){e.toggleStar(t.row)}}}),e._v(" "),t.row.isHaveFile?i("icon-svg",{staticClass:"file",attrs:{"icon-class":"label4"}}):e._e(),e._v(" "),t.row.isHaveAudio?i("icon-svg",{attrs:{"icon-class":"voice4"}}):e._e()]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"Recipient",width:"120px","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("showReceiveName")(t.row.receiveList)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"title",sortable:"custom",label:"Subject","show-overflow-tooltip":!0,"min-width":"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"link-type",on:{click:function(i){e.goToDetail(t.row.id)}}},[e._v(e._s(t.row.title))]),e._v(" "),e._l(t.row.labelList,function(t){return i("el-tag",{key:t.guid},[e._v(e._s(t.name))])})]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"sendDate",sortable:"custom",align:"center",label:"Sending time",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("parseTime")(t.row.sendDate,"{y}-{m}-{d} {h}:{i}")))])]}}])})],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.listQuery.page=t}}})],1)],1)},staticRenderFns:[]}}});