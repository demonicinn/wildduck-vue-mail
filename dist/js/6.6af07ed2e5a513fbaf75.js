webpackJsonp([6],{328:function(e,t,i){function n(e){i(637)}var a=i(1)(i(521),i(687),n,null,null);e.exports=a.exports},521:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(65),a=function(e){return e&&e.__esModule?e:{default:e}}(n),s=i(527),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(s),o=i(9);t.default={name:"mail_list",data:function(){return{list:[],total:0,listLoading:!1,listQuery:{page:1,limit:20,title:"",type:"",startDate:null,stopDate:null,sort:"",order:"",routeQuery:{}},dateRange:[],multipleSelection:[],typeOptions:[{value:"receive",showValue:"Received"},{value:"send",showValue:"Sent"}],dateOptions:{shortcuts:[{text:"Last week",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-6048e5),e.$emit("pick",[i,t])}},{text:"Last month",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-2592e6),e.$emit("pick",[i,t])}},{text:"Last three months",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-7776e6),e.$emit("pick",[i,t])}}]},searchType:null}},created:function(){this.searchType=this.$route.params.labelId?"labelId":"deleted",this.getList()},filters:{typeFilter:function(e){return{receive:"primary",send:"success"}[e]},typeShowFilter:function(e){return{receive:"Receiving",send:"Sending"}[e]}},methods:{getList:function(){var e=this;this.listQuery.startDate=this.dateRange[0]?this.dateRange[0].getTime():null,this.listQuery.stopDate=this.dateRange[1]?this.dateRange[1].getTime():null,(0,a.default)(this.listQuery.routeQuery,this.$route.params,this.$route.meta),l.fetchList(this.listQuery).then(function(t){e.list=t.data.items,e.total=t.data.total})},goToDetail:function(e){this.$store.commit("SET_MAIL_ID",e.id),this.$store.commit("SET_MAIL_TYPE",e.type),this.$router.push({path:"/mail_detail/index"})},handleFilter:function(){this.getList()},handleSizeChange:function(e){this.listQuery.limit=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()},customSort:function(e){this.listQuery.sort=e.prop,this.listQuery.order=e.order,this.getList()},forward:function(){if(1!==(this.multipleSelection.length||0))return void this.$message("Please select an email to forward");this.$store.commit("SET_MAIL_ID",this.multipleSelection[0].id),this.$store.commit("SET_PAGE_TYPE","forward"),this.$store.commit("SET_MAIL_TYPE",this.multipleSelection[0].type),this.$router.push({path:"/mail_send/index"})},handleSelectionChange:function(e){this.multipleSelection=e},handleDelete:function(){var e=this,t=this.multipleSelection.length||0;if(t<1)return void this.$message("Please select a message to delete");this.$confirm("Are you sure want to delete this"+t+" Mail?","Confirm",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(function(){var t=[];e.multipleSelection.forEach(function(e){return t.push(e.id)}),l.delMail(t).subscribe({next:function(){e.$message({message:"Successfully deleted",type:"success",duration:2e3}),e.getList()},error:function(){return e.$message({showClose:!0,message:"Failed to delete",type:"error"})}})}).catch(function(){e.$message("Operation canceled")})},unDeleted:function(){var e=this;if((this.multipleSelection.length||0)<1)return void this.$message("Please select mail to undo delete");var t=[];this.multipleSelection.forEach(function(e){return t.push(e.id)}),l.unDoDelMail(t).subscribe({next:function(){e.$message({message:"Undo delete successfully",type:"success",duration:2e3}),e.getList()},error:function(){return e.$message({showClose:!0,message:"Undo delete failed",type:"error"})}})},handleDownload:function(){var e=this;i.e(20).then(function(){var t=i(360),n=t.export_json_to_excel,a=["Sender","Sending mailbox","Subject","time"],s=["sendName","sendMail","title","date"];n(a,e.formatJson(s,e.list),(0,o.parseTime)(Date.now())+"Mailing list data")}.bind(null,i)).catch(i.oe)},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return~e.indexOf("date")?(0,o.parseTime)(t[e]):t[e]})})}}}},527:function(e,t,i){"use strict";function n(e){return(0,o.default)({url:"/mail_list",method:"get",params:e})}function a(e){var t=String(e);return console.log("The message id to delete:"+t),r.Observable.create(function(e){setTimeout(function(){e.next(!0)},500)})}function s(e){var t=String(e);return console.log("To undelete the deleted message id:"+t),r.Observable.create(function(e){setTimeout(function(){e.next(!0)},500)})}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchList=n,t.delMail=a,t.unDoDelMail=s;var l=i(38),o=function(e){return e&&e.__esModule?e:{default:e}}(l),r=i(64)},554:function(e,t,i){t=e.exports=i(311)(!0),t.push([e.i,".star{color:#f08a5d}","",{version:3,sources:["E:/node/vueJs/dAppBoxV3/src/views/mail_list/index.vue"],names:[],mappings:"AACA,MACE,aAAe,CAChB",file:"index.vue",sourcesContent:["\n.star {\r\n  color: #f08a5d;\n}\r\n"],sourceRoot:""}])},637:function(e,t,i){var n=i(554);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i(312)("313383aa",n,!0)},687:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container calendar-list-container"},[i("div",{staticClass:"filter-container"},["deleted"===e.searchType?i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"tool-item filter-item btn-add",attrs:{type:"primary"},on:{click:e.unDeleted}},[i("icon-svg",{attrs:{"icon-class":"undo"}})],1):e._e(),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"tool-item filter-item btn-forward",attrs:{type:"primary",icon:"share"},on:{click:e.forward}}),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"tool-item filter-item btn-del",attrs:{type:"danger",icon:"delete"},on:{click:function(t){e.handleDelete()}}}),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"tool-item filter-item btn-reload",attrs:{type:"primary"},on:{click:e.getList}},[i("icon-svg",{attrs:{"icon-class":"reload4"}})],1),e._v(" "),i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"Title"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;e.handleFilter(t)}},model:{value:e.listQuery.title,callback:function(t){e.listQuery.title=t},expression:"listQuery.title"}}),e._v(" "),i("el-select",{staticClass:"filter-item",staticStyle:{width:"90px"},attrs:{clearable:"",placeholder:"Types of"},model:{value:e.listQuery.type,callback:function(t){e.listQuery.type=t},expression:"listQuery.type"}},e._l(e.typeOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.showValue,value:e.value}})})),e._v(" "),i("el-date-picker",{staticClass:"tool-item filter-item",attrs:{type:"datetimerange","picker-options":e.dateOptions,placeholder:"Select time range",align:"right"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}}),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"search"},on:{click:e.handleFilter}},[e._v("Search for")]),e._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"text",icon:"document"},on:{click:e.handleDownload}},[e._v("Export")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.list,border:"","highlight-current-row":""},on:{"sort-change":e.customSort,"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection","min-width":"30px"}}),e._v(" "),i("el-table-column",{attrs:{align:"left",width:"90px",label:"information"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("icon-svg",{staticClass:"star",attrs:{"icon-class":t.row.isStar?"favourite":"favourite-o"},nativeOn:{click:function(i){e.toggleStar(t.row)}}}),e._v(" "),t.row.isHaveFile?i("icon-svg",{staticClass:"file",attrs:{"icon-class":"label4"}}):e._e(),e._v(" "),t.row.isHaveAudio?i("icon-svg",{attrs:{"icon-class":"voice4"}}):e._e()]}}])}),e._v(" "),i("el-table-column",{staticClass:"status-col",attrs:{label:"Types of",width:"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{type:e._f("typeFilter")(t.row.type)}},[e._v(e._s(e._f("typeShowFilter")(t.row.type)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"Sender"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.sendMail,placement:"top"}},[i("span",[e._v(e._s(t.row.sendName))])])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"Subject","show-overflow-tooltip":!0,"min-width":"500px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"link-type",on:{click:function(i){e.goToDetail(t.row)}}},[e._v(e._s(t.row.title))]),e._v(" "),e._l(t.row.labelList,function(t){return i("el-tag",{key:t.guid},[e._v(e._s(t.name))])})]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"date",sortable:"custom",align:"center",label:"Time",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("parseTime")(t.row.date,"{y}-{m}-{d} {h}:{i}")))])]}}])})],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.listQuery.page=t}}})],1)],1)},staticRenderFns:[]}}});